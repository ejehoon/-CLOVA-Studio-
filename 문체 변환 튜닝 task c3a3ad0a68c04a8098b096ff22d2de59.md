# 문체 변환 튜닝 task

Status: 시작 전

![스크린샷 2024-06-09 오후 8.12.25.png](%E1%84%86%E1%85%AE%E1%86%AB%E1%84%8E%E1%85%A6%20%E1%84%87%E1%85%A7%E1%86%AB%E1%84%92%E1%85%AA%E1%86%AB%20%E1%84%90%E1%85%B2%E1%84%82%E1%85%B5%E1%86%BC%20task%20c3a3ad0a68c04a8098b096ff22d2de59/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2024-06-09_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_8.12.25.png)

1. [**이슈 파악**](https://wiki.navercorp.com/pages/viewpage.action?pageId=2331597823#id-%EB%AC%B8%EC%B2%B4%EB%B3%80%ED%99%98GuideDraft-1.%EC%9D%B4%EC%8A%88%ED%8C%8C%EC%95%85)
    - 문체 변환과 요약 기능을 동시에 사용할 때 문체 변환이 되지 않는 문제 발생

1. [**원인 분석**](https://wiki.navercorp.com/pages/viewpage.action?pageId=2331597823#id-%EB%AC%B8%EC%B2%B4%EB%B3%80%ED%99%98GuideDraft-%EC%9B%90%EC%9D%B8%ED%8C%8C%EC%95%85)
    - 토큰 수가 길어질수록 문체 변환 실패 경향(약 250자 이상의 글에서 문체 변환 실패)
    - 배열 순서에 따른 영향 확인
2. [**데이터셋 만들기 & 튜닝 진행**](https://wiki.navercorp.com/pages/viewpage.action?pageId=2331597823#id-%EB%AC%B8%EC%B2%B4%EB%B3%80%ED%99%98GuideDraft-3.%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%85%8B%EB%A7%8C%EB%93%A4%EA%B8%B0&%ED%8A%9C%EB%8B%9D%EC%A7%84%ED%96%89)
    - AI 허브 논문자료 요약 데이터 활용 [링크 이동](https://www.aihub.or.kr/aihubdata/data/view.do?currMenu=&topMenu=&aihubDataSe=data&dataSetSn=90)
    - 문체 변환과 요약이 동시에 가능한 데이터셋 생성 [(구글 스프레드시트)](https://docs.google.com/spreadsheets/d/13qCsMKxqGlCqhiVOldfzXrV8jx2k3oCKMb_EOgVPtVc/edit#gid=347731647)
3. [**튜닝 결과](https://wiki.navercorp.com/pages/viewpage.action?pageId=2331597823#id-%EB%AC%B8%EC%B2%B4%EB%B3%80%ED%99%98GuideDraft-4.%ED%8A%9C%EB%8B%9D%EA%B2%B0%EA%B3%BC)** (100건 기준)
    - [HCX-003 모델](https://wiki.navercorp.com/pages/viewpage.action?pageId=2331597823#id-%EB%AC%B8%EC%B2%B4%EB%B3%80%ED%99%98GuideDraft-1.HCX-003%EB%AA%A8%EB%8D%B8%EC%9D%98%EC%B4%88%EA%B8%B0%EC%84%B1%EB%8A%A5) 초기 성능: 요약은 되지만 음슴체 변환 실패
    - [리스트 형태로 튜닝](https://wiki.navercorp.com/pages/viewpage.action?pageId=2331597823#id-%EB%AC%B8%EC%B2%B4%EB%B3%80%ED%99%98GuideDraft-2.%EB%A6%AC%EC%8A%A4%ED%8A%B8%ED%98%95%ED%83%9C%EB%A1%9C%ED%8A%9C%EB%8B%9D): 문체 변환 성공, 개수 누락 및 나열 느낌 등 문제 발생
    - [문장 형태로 튜닝](https://wiki.navercorp.com/pages/viewpage.action?pageId=2331597823#id-%EB%AC%B8%EC%B2%B4%EB%B3%80%ED%99%98GuideDraft-3.%EB%AC%B8%EC%9E%A5%ED%98%95%ED%83%9C%EB%A1%9C%ED%8A%9C%EB%8B%9D): 문체 변환 성공, 여전히 개수 누락 및 나열 느낌 등 문제 발생
    - [문체 변환에 특화](https://wiki.navercorp.com/pages/viewpage.action?pageId=2331597823#id-%EB%AC%B8%EC%B2%B4%EB%B3%80%ED%99%98GuideDraft-4.%EB%AC%B8%EC%B2%B4%EB%B3%80%ED%99%98%EC%97%90%EC%A7%91%EC%A4%91%ED%95%9C%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%85%8B%ED%99%9C%EC%9A%A9)된 데이터셋 구성: 요약 데이터 제외하고 음슴체와 '-합니다' 체 변환에 집중

## **Goal**

클로바스튜디오에서 문체 변환(음슴체)과 요약 기능을 동시에 사용할 때 문체 변환을 못하는 문제를 해결하고자 함.

## **Summary**

### 테스트 개요

- AI 허브의 논문 자료 요약 데이터를 활용하여 튜닝 데이터셋을 구성함
    - 논문 내용은 음슴체로 변환하여 Text열에, 요약 내용은 '-합니다' 체로 변환하여 Completion열에 저장 후 학습
- 논문 자료 요약 데이터 예시
    
    ```python
                "summary_section": [
                   {
                      "orginal_text": "‘고전문학교육’을 위해 ‘고전 시대의 문학 교육’의 양상을 살펴보는 일은 그 용어의 개념적인 면에서나 실제의 문화적 전통이라는 면에서나 소중한 일이다. 이에 대해 ‘과거 제도사’나 ‘학교 제도사’라는 측면에서 역사적 실상을 접근하려는 축과, 중세적 글쓰기의 양상을 간추려 그 문학 교육적 함의를 추론하려는 축으로 그 동안 적지 않은 연구 성과가 축적되었다. 전자가 교육제도의 변천에 중점을 두고 있다면, 후자는 중세 글쓰기의 현재적 가치를 추출해내는 데에 더 중점을 두고 있다. 그러나 모두 ‘고전 시대의 문학 교육’의 양상을 등한시 했다는 결함이 있다. 우리나라 중세시대에서 문학은 지금과는 다른 위치를 차지했다. 중세에는 문인이 사회적 헤게모니를 장악하고 있었고, 당연한 말이겠지만, 그들의 교양 중에서 문학은 다른 교양을 압도하는 주도적이고 본질적인 부분을 차지하고 있었다. 그래서 문학은 가옥의 배열이나 마을의 배치를 설명하거나, 귀신을 내쫓고 운명을 예견하는 일까지도 할 수 있는 것으로 여겨졌다.",
                      "summary_text": "우리나라 중세시대 문학은 지금과는 다른 위치를 차지했다. 중세에는 문인이 사회적 헤게모니를 장악하고, 그들의 교양 중에서 문학은 다른 교양을 압도하는 주도적이고 본질적인 부분을 차지하고 있었다."
                   }
    ```
    
- 튜닝 데이터셋 구성 방식에 따른 성능 차이를 확인하기 위해 다음과 같은 테스트 진행
    - **문장 형태로 튜닝**: 원문 내용은 음슴체로 Text열에 , 요약 내용은 '-합니다' 체로 Completion열에 변환하여 학습
    - **리스트 형태로 튜닝**: 원문 내용은 음슴체로 Text열에 , 요약 내용은 '-합니다' 체로 Completion열에 변환하고 리스트 형식으로 변환 후 학습
    - **문체 변환에 특화**된 데이터셋 구성: 요약 데이터를 제외하고 문체 변환에만 집중, 원문에 음슴체와 '-합니다' 체 변환 규칙을 각각 적용하여 Text열과 Completion열에 저장

### 테스트 결과

- **문장 형태**로 튜닝 시 문체 변환은 성공했지만 개수 누락, 나열 느낌, 데이터 양이 증가하면 리스트 형태로 표현하지 못하는 문제 발생
- **리스트 형태**로 튜닝 시 문체 변환은 성공했지만 개수 누락, 나열 느낌, 데이터 양 증가 시 원하지 않아도 리스트 형태로만 답변하는 문제 등이 발생함
- **문체 변환에 특화**된 데이터셋 구성 시 요약이 나열되는 느낌은 부분적으로 해소되었으나, 개수 누락이 여전히 발생함
- 문체 변환에 특화된 데이터셋이 현재까지는 가장 긍정적이지만, 나열 느낌이 나는 문제와 종종 발생하는 개수 누락 문제를 해결하기 위해 추가적인 개선이 필요함
    - 현재 리스트+요약 제외, 문장+요약 제외 등의 데이터셋으로 학습시키며 변화를 주고 있지만, 아직 뚜렷한 긍정적 변화는 찾지 못한 상황임

---

## **1. 이슈 파악**

- 현재 문체 변환 기능과 요약 기능을 동시에 요청 했을때 문체 변환이 되지 않는 문제가 있음.

**문체변환과 요약을 동시에 진행할 때 문체변환이 되지 않던 문제**

- HCX-003 문체 변환 + 요약 결과
    
    
    | System | Text | Completion |
    | --- | --- | --- |
    | - 주어진 문장을 -합니다 체로 변경하면서 요약합니다. - 음슴체를 -합니다 체로 변경하면서 요약합니다.- 하다 체를 - 합니다 체로 변경하면서 요약합니다. - 요약된 문장의 어미를 -합니다 체로 변경합니다. - 리스트 형태로 요약합니다. ### 예시 강점:- n개 문체변환 요약 약점: - n개 문체변환 요약 종합의견: - n개 문체변환 요약 | 강점,약점,종합의견 3개씩 요약해줘
    손흥민은 공격적인 능력이 특화된 윙어임. 빠른 스피드와 뛰어난 드리블 능력, 정확한 슈팅력으로 유명함. 양발을 자유자재로 사용하는 능력 덕분에 다양한 위치에서 위협적인 득점 찬스를 만들 수 있음. 공격 상황에서의 침투와 위치 선정이 뛰어나며, 상대 수비수들의 허를 찌르는 움직임으로 자주 골을 기록함. 특히 공간을 빠르게 파고드는 능력이 탁월함. 그러나 볼터치가 정교하지 못한 단점이 있음. 손흥민은 또한 수비 가담에도 적극적임. 전방 압박 상황에서 상대의 빌드업을 차단하며 팀의 수비 부담을 덜어주는 역할을 자주 수행함. 그러나 가끔씩 지나친 공격 가담으로 인해 수비로 돌아오는 속도가 늦어질 때가 있음. 이러한 점을 보완하기 위해 체력 관리와 위치 선정에서 더욱 신중해지는 것이 필요함. 또한 몸싸움이 약해 강한 신장을 가진 선수들에게 약한 모습을 보여줌. 국제 무대에서도 활약이 돋보임. 한국 국가대표팀의 주축 선수로서 여러 국제 대회에서 뛰어난 활약을 펼쳤으며, 특히 2018년 러시아 월드컵에서 독일을 상대로 한 골은 역사적인 순간으로 기억됨. 손흥민은 앞으로도 더욱 발전할 가능성이 큰 선수로, 그의 플레이 스타일과 다재다능함은 팀에 큰 자산이 되고 있음.
     | 강점 : - 빠른 스피드와 뛰어난 드리블 능력을 가지고 있음 - 정확한 슈팅력으로 득점 찬스를 만듬 - 양발을 사용하여 다양한 위치에서 득점이 가능 약점 : - 볼터치가 정교하지 못함 - 강한 신장을 가진 선수들에게 약한 모습을 보임 - 수비 가담 시, 공격 가담으로 인해 수비로 돌아오는 속도가 늦어짐 종합의견 : - 공격적인 능력이 특화된 윙어로 팀에 큰 자산이 될 수 있음 - 국제 무대에서도 활약이 돋보이며 앞으로 더욱 발전할 가능성이 큼 - 체력 관리와 위치 선정에서 더욱 신중해지는 것이 필요 |

## **2. 원인 파악**

1. 토큰 수에 따른 문체 변환 성공 여부
    - 토큰 수가 길어질수록 문체 변환이 실패하는 경향이 있음
        - 토큰에 따른 문체 변환 성공 (193자)
            
            사용자
            
            ```python
            3가지로 요약해줘
            손흥민은 공격적인 능력이 특화된 윙어임. 빠른 스피드와 뛰어난 드리블 능력, 정확한 슈팅력으로 유명함. 양발을 자유자재로 사용하는 능력 덕분에 다양한 위치에서 위협적인 득점 찬스를 만들 수 있음. 공격 상황에서의 침투와 위치 선정이 뛰어나며, 상대 수비수들의 허를 찌르는 움직임으로 자주 골을 기록함. 특히 공간을 빠르게 파고드는 능력이 탁월함.
            ```
            
            어시스턴트
            
            ```python
            요약 : 
            - 손흥민은 빠른 스피드와 뛰어난 드리블 능력을 가진 윙어입니다.
            - 양발을 사용하는 능력으로 다양한 위치에서 득점 기회를 만듭니다.
            - 슈팅력은 부정확하지만, 공격적인 능력이 특화되어 있습니다.
            ```
            
        - 토큰에 따른 문체 변환 실패 (267자)
            
            사용자
            
            ```python
            3가지로 요약해줘 
            손흥민은 공격적인 능력이 특화된 윙어임. 빠른 스피드와 뛰어난 드리블 능력, 정확한 슈팅력으로 유명함. 양발을 자유자재로 사용하는 능력 덕분에 다양한 위치에서 위협적인 득점 찬스를 만들 수 있음. 공격 상황에서의 침투와 위치 선정이 뛰어나며, 상대 수비수들의 허를 찌르는 움직임으로 자주 골을 기록함. 특히 공간을 빠르게 파고드는 능력이 탁월함. 손흥민은 또한 수비 가담에도 적극적임. 전방 압박 상황에서 상대의 빌드업을 차단하며 팀의 수비 부담을 덜어주는 역할을 자주 수행함.
            ```
            
            어시스턴트
            
            ```python
            요약 : 
            - 손흥민은 빠른 스피드와 뛰어난 드리블 능력, 정확한 슈팅력을 가진 윙어로 양발을 사용하여 다양한 위치에서 득점 찬스를 만듦
            - 공격 상황에서 침투와 위치 선정이 뛰어나며, 상대 수비수의 허를 찌르는 움직임으로 골을 기록하며 공간을 빠르게 파고드는 능력이 탁월함
            - 수비 가담에도 적극적이며 전방 압박 상황에서 상대 빌드업을 차단하며 팀의 수비 부담을 덜어줌
            ```
            

## **3. 데이터셋 만들기 & 튜닝 진행**

### 데이터 수집

- **대상 태스크:** 문체 변환 + 요약 동시에 가능한 데이터셋 만들기
- **튜닝 모델:** HCX-003
- **튜닝 세팅:**
    - method: LORA
    - taskType: GENERATION
    - trainEpochs: 4
    - learningRate: 1e-4
    - Top-K: 0
    - Top-P: 0.6
    - Max Tokens: 256
    - Repetition Penalty: 1.2
    - Temperature: 0.5

### 데이터

- **학습 데이터:** AI 허브에서 제공하는 논문 자료 요약 데이터(JSON 형식)를 활용 [링크](https://www.aihub.or.kr/aihubdata/data/view.do?currMenu=115&topMenu=100&aihubDataSe=data&dataSetSn=90)
    - JSON 데이터의 "original_text" 필드에는 작성된 논문 내용(약 500자)이 포함되어 있음
        1. JSON 데이터를 파싱하여 "original_text"를 추출
        2. 추출한 "original_text"를 음슴체로 변환 후 학습 데이터셋의 "Text" 열에 저장
        3. 추출한 "original_text"를 '-합니다' 체로 변환하여 학습 데이터셋의 "Completion" 열에 저장
- **평가 데이터:**
    - 평균 500자 이상으로 구성된 음슴체 데이터 100개

### 학습 데이터 생성 코드

이 파이썬 코드는 AI 허브에서 제공하는 논문 자료 요약 데이터(json)를 활용하여 문체 변환과 요약을 동시에 수행할 수 있는 학습 데이터를 생성합니다. 주요 기능은 다음과 같습니다:

- 논문 자료 요약 데이터 예시
    
    ```python
                "summary_section": [
                   {
                      "orginal_text": "‘고전문학교육’을 위해 ‘고전 시대의 문학 교육’의 양상을 살펴보는 일은 그 용어의 개념적인 면에서나 실제의 문화적 전통이라는 면에서나 소중한 일이다. 이에 대해 ‘과거 제도사’나 ‘학교 제도사’라는 측면에서 역사적 실상을 접근하려는 축과, 중세적 글쓰기의 양상을 간추려 그 문학 교육적 함의를 추론하려는 축으로 그 동안 적지 않은 연구 성과가 축적되었다. 전자가 교육제도의 변천에 중점을 두고 있다면, 후자는 중세 글쓰기의 현재적 가치를 추출해내는 데에 더 중점을 두고 있다. 그러나 모두 ‘고전 시대의 문학 교육’의 양상을 등한시 했다는 결함이 있다. 우리나라 중세시대에서 문학은 지금과는 다른 위치를 차지했다. 중세에는 문인이 사회적 헤게모니를 장악하고 있었고, 당연한 말이겠지만, 그들의 교양 중에서 문학은 다른 교양을 압도하는 주도적이고 본질적인 부분을 차지하고 있었다. 그래서 문학은 가옥의 배열이나 마을의 배치를 설명하거나, 귀신을 내쫓고 운명을 예견하는 일까지도 할 수 있는 것으로 여겨졌다.",
                      "summary_text": "우리나라 중세시대 문학은 지금과는 다른 위치를 차지했다. 중세에는 문인이 사회적 헤게모니를 장악하고, 그들의 교양 중에서 문학은 다른 교양을 압도하는 주도적이고 본질적인 부분을 차지하고 있었다."
                   }
    ```
    
1. JSON 파일에서 데이터를 읽어옵니다.
2. `replacements.py` 파일에 정의된 변환 규칙을 사용하여 추출한 "original_text"를 음슴체와 '-합니다' 체로 각각 변환합니다.
    - 음슴체로 변환된 텍스트는 "Text" 열에 저장됩니다.
    - '-합니다' 체로 변환된 텍스트는 "Completion" 열에 저장됩니다.
3. 변환된 텍스트를 포함한 데이터를 엑셀 파일로 저장합니다.

## 도움말

`replacements.py` 파일을 별도로 생성하여 음슴체와 '-합니다' 체 간의 변환 규칙을 정의했습니다.

이 파일에는 학습 데이터셋의 "Text" 열에 저장할 때 사용되는 informal_replacements과 "Completion" 열에 저장할 때 사용되는 formal_replacements의 두 가지 사전이 포함되어 있습니다.

이를 통해 문체 변환 규칙을 코드에서 분리하여 관리할 수 있습니다.

---

- replacements.py
    
    ```python
    # Text열에 저장 (음슴체)
    informal_replacements = {
        "하였다.": "함.",
        "하다.": "함.",    
        "했다.": "했음.",
        "되었다.": "되었음.",
        "된다.": "됨.",
        "있다.": "있음.",
        "것이다.": "것임.",
        "한다.": "함.",
        "있었다.": "있었음.",
        "되어졌다.": "되어짐.",
        "이루어졌다.": "이루어짐.",
        "보였다.": "보임.",
        "이다.": "임.",
        "졌다.": "졌음.",
        "준다.": "줌."
    
    }
    
    # Completion열에 저장 (-합니다체)
    formal_replacements = {
        "이다.": "입니다.",
        "었다.": "었습니다.",
        "준다.": "줍니다.",
        "한다.": "합니다.",
        "였다.": "였습니다.",
        "웠다.": "웠습니다.",
        "았다.": "았습니다.",
        "른다.": "립니다.",
        "드물다.": "드뭅니다.",
        "된다.": "됩니다.",
        "했다.": "했습니다.",
        "않다.": "않습니다.",
        "하다.": "합니다.",
        "같다.": "같습니다.",
        "왔다.": "왔습니다.",
        "닌다.": "닙니다.",
        "르다.": "릅니다.",
        "본다.": "봅니다.",
        "눈다.": "눕니다.",
        "진다.": "집니다.",
        "없다.": "없습니다.",
        "많다.": "많습니다.",
        "높다.": "높습니다.",
        "인다.": "입니다.",
        "리다.": "립니다.",
        "컫는다.": "컫습니다.",
        "겠다.": "겠습니다.",
        "않는다.": "않습니다.",
        "뉜다.": "뉩니다.",
        "낀다.": "낍니다.",
        "보여줌.": "보여줍니다.",
        "임.": "입니다.",
        "음.": "습니다.",
        "림.": "립니다.",
        "냄.": "냅니다.",
        "재침.": "재칩니다.",
        "있다.": "있습니다.",
        "됨.": "됐습니다.",
        "함.": "합니다.",
    
    }
    ```
    

이 코드를 통해 문체 변환과 요약 작업을 위한 학습 데이터를 효율적으로 생성할 수 있습니다.

- 데이터 생성 코드
    
    ```python
     import json
    import pandas as pd
    import re
    import os
    from replacements import formal_replacements, informal_replacements
    
    # 주어진 텍스트에서 replacements 딕셔너리를 기반으로 구문을 교체합니다.
    def replace_phrases(text, replacements):
        for old, new in replacements.items():
            text = re.sub(r'(?<![\w])' + re.escape(old) + r'(?![\w])', new, text)
            text = re.sub(r'(?<![\w])' + re.escape(old), new, text)
            text = re.sub(r'' + re.escape(old) + r'(?![\w])', new, text)
        return text
    
    # JSON 파일 경로 설정
    json_file_path = '</path/to/your/json_file.json>'
    output_file_path = '</path/to/your/output.xlsx>'
    
    try:
        with open(json_file_path, 'r', encoding='utf-8') as file:
            data = json.load(file)
        print("JSON 파일을 성공적으로 읽어들였습니다.")
    except json.JSONDecodeError:
        print("JSON 파일을 파싱하는 중에 오류가 발생했습니다.")
        exit()
    
    excel_data = {
        "System": [],
        "C_ID": [],
        "T_ID": [],
        "Text": [],
        "Completion": []
    }
    
    # 가져올 데이터 개수
    count = 0
    data_count = 400
    
    try:
        for item in data:
            for entry in item['data']:
                for summary in entry.get('summary_section', []):
                    if count >= data_count:
                        break
    
                    original_text = summary['orginal_text']
                    
                    # 원본 텍스트에 음슴체 변환 규칙 적용하여 "Text" 열에 저장
                    text_informal = replace_phrases(original_text, informal_replacements)
                    
                    # 원본 텍스트에 '-합니다' 체 변환 규칙 적용하여 "Completion" 열에 저장
                    completion_formal = replace_phrases(original_text, formal_replacements)
                    
                    # 엑셀 데이터에 추가
                    excel_data["System"].append(None)
                    excel_data["C_ID"].append(None)
                    excel_data["T_ID"].append(None)
                    excel_data["Text"].append(text_informal)
                    excel_data["Completion"].append(completion_formal)
                    
                    count += 1
                if count >= data_count:
                    break
            if count >= data_count:
                break
    
        df = pd.DataFrame(excel_data)
        os.makedirs(os.path.dirname(output_file_path), exist_ok=True)
    
        # 엑셀 파일로 저장
        try:
            df.to_excel(output_file_path, index=False)
            print(f"성공적으로 완료되었습니다. 파일이 다음 위치에 저장되었습니다: {output_file_path}")
        except Exception as e:
            print(f"엑셀 파일을 저장하는 중에 오류가 발생했습니다: {e}")
    except Exception as e:
        print(f"데이터 처리 중에 오류가 발생했습니다: {e}")
     
    ```
    

학습 데이터셋 예시1)

| System | Text | Completion |
| --- | --- | --- |
| - 주어진 문장을 -합니다 체로 변경합니다. - 음슴체를 -합니다 체로 변경합니다. - 하다 체를 - 합니다 체로 변경합니다. - 문장의 어미를 -합니다 체로 변경합니다. | ‘고전문학교육’을 위해 ‘고전 시대의 문학 교육’의 양상을 살펴보는 일은 그 용어의 개념적인 면에서나 실제의 문화적 전통이라는 면에서나 소중한 일임. 이에 대해 ‘과거 제도사’나 ‘학교 제도사’라는 측면에서 역사적 실상을 접근하려는 축과, 중세적 글쓰기의 양상을 간추려 그 문학 교육적 함의를 추론하려는 축으로 그 동안 적지 않은 연구 성과가 축적되었음. 전자가 교육제도의 변천에 중점을 두고 있다면, 후자는 중세 글쓰기의 현재적 가치를 추출해내는 데에 더 중점을 두고 있음. 그러나 모두 ‘고전 시대의 문학 교육’의 양상을 등한시 했다는 결함이 있음. 우리나라 중세시대에서 문학은 지금과는 다른 위치를 차지했음. 중세에는 문인이 사회적 헤게모니를 장악하고 있었고, 당연한 말이겠지만, 그들의 교양 중에서 문학은 다른 교양을 압도하는 주도적이고 본질적인 부분을 차지하고 있었음. 그래서 문학은 가옥의 배열이나 마을의 배치를 설명하거나, 귀신을 내쫓고 운명을 예견하는 일까지도 할 수 있는 것으로 여겨졌음. | ‘고전문학교육’을 위해 ‘고전 시대의 문학 교육’의 양상을 살펴보는 일은 그 용어의 개념적인 면에서나 실제의 문화적 전통이라는 면에서나 소중한 일입니다. 이에 대해 ‘과거 제도사’나 ‘학교 제도사’라는 측면에서 역사적 실상을 접근하려는 축과, 중세적 글쓰기의 양상을 간추려 그 문학 교육적 함의를 추론하려는 축으로 그 동안 적지 않은 연구 성과가 축적되었습니다. 전자가 교육제도의 변천에 중점을 두고 있다면, 후자는 중세 글쓰기의 현재적 가치를 추출해내는 데에 더 중점을 두고 있습니다. 그러나 모두 ‘고전 시대의 문학 교육’의 양상을 등한시 했다는 결함이 있습니다. 우리나라 중세시대에서 문학은 지금과는 다른 위치를 차지했습니다. 중세에는 문인이 사회적 헤게모니를 장악하고 있었고, 당연한 말이겠지만, 그들의 교양 중에서 문학은 다른 교양을 압도하는 주도적이고 본질적인 부분을 차지하고 있었습니다. 그래서 문학은 가옥의 배열이나 마을의 배치를 설명하거나, 귀신을 내쫓고 운명을 예견하는 일까지도 할 수 있는 것으로 여겨졌습니다. |

[데이터셋 (구글 스프레드시트)](https://docs.google.com/spreadsheets/d/13qCsMKxqGlCqhiVOldfzXrV8jx2k3oCKMb_EOgVPtVc/edit?usp=sharing)

## **4. 튜닝 결과**

문체 변환과 요약을 동시에 수행하는 모델을 튜닝하는 과정에서 다양한 시도와 비교를 통해 최적의 방법을 찾아갔습니다.

튜닝 데이터 개수는 100개의 데이터를 기반으로 작성했습니다.

### **1. HCX-003 모델의 초기 성능**

HCX-003 모델을 사용하여 문체 변환과 요약을 동시에 수행하려 했습니다.

요약은 되지만 음슴체 변환에 실패하는 문제가 발생했습니다.

---

- HCX-003 결과보기
    
    
    | System | Text | Completion |
    | --- | --- | --- |
    | - 주어진 문장을 -합니다 체로 변경하면서 요약합니다. - 음슴체를 -합니다 체로 변경하면서 요약합니다.- 하다 체를 - 합니다 체로 변경하면서 요약합니다. - 요약된 문장의 어미를 -합니다 체로 변경합니다. - 리스트 형태로 요약합니다. ### 예시 강점:- n개 문체변환 요약 약점: - n개 문체변환 요약 종합의견: - n개 문체변환 요약 | 강점,약점,종합의견 3개씩 요약해줘
    손흥민은 공격적인 능력이 특화된 윙어임. 빠른 스피드와 뛰어난 드리블 능력, 정확한 슈팅력으로 유명함. 양발을 자유자재로 사용하는 능력 덕분에 다양한 위치에서 위협적인 득점 찬스를 만들 수 있음. 공격 상황에서의 침투와 위치 선정이 뛰어나며, 상대 수비수들의 허를 찌르는 움직임으로 자주 골을 기록함. 특히 공간을 빠르게 파고드는 능력이 탁월함. 그러나 볼터치가 정교하지 못한 단점이 있음. 손흥민은 또한 수비 가담에도 적극적임. 전방 압박 상황에서 상대의 빌드업을 차단하며 팀의 수비 부담을 덜어주는 역할을 자주 수행함. 그러나 가끔씩 지나친 공격 가담으로 인해 수비로 돌아오는 속도가 늦어질 때가 있음. 이러한 점을 보완하기 위해 체력 관리와 위치 선정에서 더욱 신중해지는 것이 필요함. 또한 몸싸움이 약해 강한 신장을 가진 선수들에게 약한 모습을 보여줌. 국제 무대에서도 활약이 돋보임. 한국 국가대표팀의 주축 선수로서 여러 국제 대회에서 뛰어난 활약을 펼쳤으며, 특히 2018년 러시아 월드컵에서 독일을 상대로 한 골은 역사적인 순간으로 기억됨. 손흥민은 앞으로도 더욱 발전할 가능성이 큰 선수로, 그의 플레이 스타일과 다재다능함은 팀에 큰 자산이 되고 있음.
     | 강점 : 
    - 빠른 스피드와 뛰어난 드리블 능력을 가지고 있음
    - 정확한 슈팅력으로 득점 기회를 잘 만듦
    - 양발을 자유롭게 사용하여 다양한 위치에서 득점 기회를 창출함
    약점 : 
    - 볼터치가 정교하지 못함
    - 몸싸움이 약해 강한 신장을 가진 선수들에게 약한 모습을 보임
    - 지나친 공격 가담으로 수비로 돌아오는 속도가 늦어질 때가 있음
    종합 의견 : 
    - 손흥민은 공격적인 능력이 특화된 윙어로 빠른 스피드와 뛰어난 드리블 능력, 정확한 슈팅력으로 유명하며 양발을 사용하는 능력 덕분에 다양한 위치에서 득점 기회를 만들 수 있음
    - 공간을 빠르게 파고드는 능력이 탁월하며 수비 가담에도 적극적이지만 볼터치가 정교하지 못하고 몸싸움이 약하며 강한 신장을 가진 선수들에게 약한 모습을 보임
    - 국제 무대에서도 활약이 돋보이며 앞으로도 더욱 발전할 가능성이 큰 선수로 평가됨 |

### **2. 리스트 형태로 튜닝**

튜닝 데이터 Text에는 음슴체를, Completion에는 요약 데이터를 리스트 형태의 '-하다' 체로 변환하여 저장하였습니다. HCX-003에서 발생한 문체 변환은 성공했지만 몇 가지 문제점이 발견되었습니다.

- 지정한 개수대로 리스트가 생성되지 않는 문제
- 요약이 나열 느낌이 강한 문제
- 데이터 개수 증가 시 원하지 않아도 리스트 형태로 답변하는 문제
- 학습 데이터
    
    ```python
    # System
    
    - 주어진 문장을 -합니다 체로 변경하면서 요약합니다. 
    - 음슴체를 -합니다 체로 변경하면서 요약합니다.
    - 하다 체를 - 합니다 체로 변경하면서 요약합니다. 
    - 요약된 문장의 어미를 -합니다 체로 변경합니다. 
    - 리스트 형태로 요약합니다. 
    ### 예시 
    강점:
    - n개 문체변환 요약 
    약점:
    - n개 문체변환 요약
    종합의견: 
    - n개 문체변환 요약 
    ```
    
    ```python
    # Text
    
    2개로 요약해줘
    ‘고전문학교육’을 위해 ‘고전 시대의 문학 교육’의 양상을 살펴보는 일은 그 용어의 개념적인 면에서나 실제의 문화적 전통이라는 면에서나 소중한 일임. 이에 대해 ‘과거 제도사’나 ‘학교 제도사’라는 측면에서 역사적 실상을 접근하려는 축과, 중세적 글쓰기의 양상을 간추려 그 문학 교육적 함의를 추론하려는 축으로 그 동안 적지 않은 연구 성과가 축적되었음. 전자가 교육제도의 변천에 중점을 두고 있다면, 후자는 중세 글쓰기의 현재적 가치를 추출해내는 데에 더 중점을 두고 있음. 그러나 모두 ‘고전 시대의 문학 교육’의 양상을 등한시 했다는 결함이 있음. 우리나라 중세시대에서 문학은 지금과는 다른 위치를 차지했음. 중세에는 문인이 사회적 헤게모니를 장악하고 있었고, 당연한 말이겠지만, 그들의 교양 중에서 문학은 다른 교양을 압도하는 주도적이고 본질적인 부분을 차지하고 있었음. 그래서 문학은 가옥의 배열이나 마을의 배치를 설명하거나, 귀신을 내쫓고 운명을 예견하는 일까지도 할 수 있는 것으로 여겨졌음.
    ```
    
    ```python
    # Completion
    
    1. 우리나라 중세시대 문학은 지금과는 다른 위치를 차지했습니다.
    2. 중세에는 문인이 사회적 헤게모니를 장악하고, 그들의 교양 중에서 문학은 다른 교양을 압도하는 주도적이고 본질적인 부분을 차지하고 있었습니다.
    ```
    
- 리스트 형태 튜닝 결과보기
    
    
    | System | Text | Completion |
    | --- | --- | --- |
    | - 주어진 문장을 -합니다 체로 변경하면서 요약합니다. - 음슴체를 -합니다 체로 변경하면서 요약합니다.- 하다 체를 - 합니다 체로 변경하면서 요약합니다. - 요약된 문장의 어미를 -합니다 체로 변경합니다. - 리스트 형태로 요약합니다. ### 예시 강점:- n개 문체변환 요약 약점: - n개 문체변환 요약 종합의견: - n개 문체변환 요약 | 강점,약점,종합의견 3개씩 요약해줘
    손흥민은 공격적인 능력이 특화된 윙어임. 빠른 스피드와 뛰어난 드리블 능력, 정확한 슈팅력으로 유명함. 양발을 자유자재로 사용하는 능력 덕분에 다양한 위치에서 위협적인 득점 찬스를 만들 수 있음. 공격 상황에서의 침투와 위치 선정이 뛰어나며, 상대 수비수들의 허를 찌르는 움직임으로 자주 골을 기록함. 특히 공간을 빠르게 파고드는 능력이 탁월함. 그러나 볼터치가 정교하지 못한 단점이 있음. 손흥민은 또한 수비 가담에도 적극적임. 전방 압박 상황에서 상대의 빌드업을 차단하며 팀의 수비 부담을 덜어주는 역할을 자주 수행함. 그러나 가끔씩 지나친 공격 가담으로 인해 수비로 돌아오는 속도가 늦어질 때가 있음. 이러한 점을 보완하기 위해 체력 관리와 위치 선정에서 더욱 신중해지는 것이 필요함. 또한 몸싸움이 약해 강한 신장을 가진 선수들에게 약한 모습을 보여줌. 국제 무대에서도 활약이 돋보임. 한국 국가대표팀의 주축 선수로서 여러 국제 대회에서 뛰어난 활약을 펼쳤으며, 특히 2018년 러시아 월드컵에서 독일을 상대로 한 골은 역사적인 순간으로 기억됨. 손흥민은 앞으로도 더욱 발전할 가능성이 큰 선수로, 그의 플레이 스타일과 다재다능함은 팀에 큰 자산이 되고 있음.
     | 강점: 
    - 빠른 스피드와 뛰어난 드리블 능력, 정확한 슈팅력으로 유명합니다. 
    - 양발을 자유자재로 사용하는 능력 덕분에 다양한 위치에서 위협적인 득점 찬스를 만들 수 있습니다.
    - 공격 상황에서의 침투와 위치 선정이 뛰어납니다.
    약점: 
    - 볼터치가 정교하지 못한 단점이 있습니다.
    - 가끔씩 지나친 공격 가담으로 인해 수비로 돌아오는 속도가 늦어질 때가 있습니다.
    - 몸싸움이 약해 강한 신장을 가진 선수들에게 약한 모습을 보여줍니다.
    종합의견: 
    - 손흥민은 앞으로도 더욱 발전할 가능성이 큰 선수로, 그의 플레이 스타일과 다재다능함은 팀에 큰 자산이 되고 있습니다. |

### **3. 문장 형태로 튜닝**

리스트 형태의 문제점을 해결하기 위해 요약 데이터를 문장 형태로 Completion에 저장하고 출력하도록 시도했습니다. 문체 변환은 성공했지만, 여러가지 문제가 발생했습니다.

- 지정한 개수대로 리스트가 생성되지 않는 문제
- 요약이 나열 느낌이 강한 문제
- 데이터 양이 늘어나면 리스트 형태로 잘 표현하지 못하는 문제
- 학습 데이터
    
    ```python
    # System
    - 주어진 문장을 -합니다 체로 변경하면서 요약합니다. 
    - 음슴체를 -합니다 체로 변경하면서 요약합니다.
    - 하다 체를 - 합니다 체로 변경하면서 요약합니다. 
    - 요약된 문장의 어미를 -합니다 체로 변경합니다. 
    ```
    
    ```python
    # Text
    
    ‘고전문학교육’을 위해 ‘고전 시대의 문학 교육’의 양상을 살펴보는 일은 그 용어의 개념적인 면에서나 실제의 문화적 전통이라는 면에서나 소중한 일임. 이에 대해 ‘과거 제도사’나 ‘학교 제도사’라는 측면에서 역사적 실상을 접근하려는 축과, 중세적 글쓰기의 양상을 간추려 그 문학 교육적 함의를 추론하려는 축으로 그 동안 적지 않은 연구 성과가 축적되었음. 전자가 교육제도의 변천에 중점을 두고 있다면, 후자는 중세 글쓰기의 현재적 가치를 추출해내는 데에 더 중점을 두고 있음. 그러나 모두 ‘고전 시대의 문학 교육’의 양상을 등한시 했다는 결함이 있음. 우리나라 중세시대에서 문학은 지금과는 다른 위치를 차지했음. 중세에는 문인이 사회적 헤게모니를 장악하고 있었고, 당연한 말이겠지만, 그들의 교양 중에서 문학은 다른 교양을 압도하는 주도적이고 본질적인 부분을 차지하고 있었음. 그래서 문학은 가옥의 배열이나 마을의 배치를 설명하거나, 귀신을 내쫓고 운명을 예견하는 일까지도 할 수 있는 것으로 여겨졌음.
    ```
    
    ```python
    # Completion
    
    우리나라 중세시대 문학은 지금과는 다른 위치를 차지했습니다. 중세에는 문인이 사회적 헤게모니를 장악하고, 그들의 교양 중에서 문학은 다른 교양을 압도하는 주도적이고 본질적인 부분을 차지하고 있었습니다.
    ```
    
- 문장 형태 튜닝 결과보기
    
    
    | System | Text | Completion |
    | --- | --- | --- |
    | - 주어진 문장을 -합니다 체로 변경하면서 요약합니다. - 음슴체를 -합니다 체로 변경하면서 요약합니다. - 하다 체를 - 합니다 체로 변경하면서 요약합니다. - 요약된 문장의 어미를 -합니다 체로 변경합니다. | 강점,약점,종합의견 3개씩 요약해줘
    손흥민은 공격적인 능력이 특화된 윙어임. 빠른 스피드와 뛰어난 드리블 능력, 정확한 슈팅력으로 유명함. 양발을 자유자재로 사용하는 능력 덕분에 다양한 위치에서 위협적인 득점 찬스를 만들 수 있음. 공격 상황에서의 침투와 위치 선정이 뛰어나며, 상대 수비수들의 허를 찌르는 움직임으로 자주 골을 기록함. 특히 공간을 빠르게 파고드는 능력이 탁월함. 그러나 볼터치가 정교하지 못한 단점이 있음. 손흥민은 또한 수비 가담에도 적극적임. 전방 압박 상황에서 상대의 빌드업을 차단하며 팀의 수비 부담을 덜어주는 역할을 자주 수행함. 그러나 가끔씩 지나친 공격 가담으로 인해 수비로 돌아오는 속도가 늦어질 때가 있음. 이러한 점을 보완하기 위해 체력 관리와 위치 선정에서 더욱 신중해지는 것이 필요함. 또한 몸싸움이 약해 강한 신장을 가진 선수들에게 약한 모습을 보여줌. 국제 무대에서도 활약이 돋보임. 한국 국가대표팀의 주축 선수로서 여러 국제 대회에서 뛰어난 활약을 펼쳤으며, 특히 2018년 러시아 월드컵에서 독일을 상대로 한 골은 역사적인 순간으로 기억됨. 손흥민은 앞으로도 더욱 발전할 가능성이 큰 선수로, 그의 플레이 스타일과 다재다능함은 팀에 큰 자산이 되고 있음.
     | 강점: 
    - 빠른 스피드와 뛰어난 드리블 능력을 가지고 있습니다. 
    - 정확한 슈팅력으로 득점을 많이 합니다. 
    - 양발을 자유자재로 사용하는 능력이 있습니다. 
    약점: 
    - 볼터치가 정교하지 못합니다. 
    - 몸싸움이 약해 강한 신장을 가진 선수들에게 약한 모습을 보여줍니다. 
    - 가끔씩 지나친 공격 가담으로 인해 수비로 돌아오는 속도가 늦어질 때가 있습니다. 
    종합의견: 
    - 손흥민은 공격적인 능력이 특화된 윙어입니다. 
    - 국제 무대에서도 활약이 돋보이며, 앞으로도 더욱 발전할 가능성이 큰 선수입니다. |

### **4. 문체 변환에 집중한 데이터셋 활용**

기존에는 요약 데이터를 사용하여 문체 변환과 요약이 된 데이터를 학습시키려 했으나, 요약 결과가 나열되는 등의 문제가 발생했습니다. 이를 해결하기 위해 요약 데이터를 제외하고 문체 변환에만 집중하는 방향으로 데이터셋을 구성했습니다.

원문에 음슴체와 '-합니다' 체 변환 규칙을 각각 적용하여 Text열과 Completion열에 저장하여, 모델이 문체 변환에 특화될 수 있도록 했습니다. 이러한 변화로 인해 요약이 나열되는 느낌은 부분적으로 해소되었지만, 여전히 몇 가지 문제점이 발견되었습니다.

- 지정한 개수대로 리스트가 생성되지 않는 문제
- 요약이 나열 느낌이 나는 문제 (부분 해소)
- 데이터 양이 늘어나면 리스트 형태로 잘 표현하지 못하는 문제

- 학습 데이터
    
    ```python
    # System
    
    - 주어진 문장을 -합니다 체로 변경합니다.
    - 음슴체를 -합니다 체로 변경합니다.
    - 하다 체를 - 합니다 체로 변경합니다.
    - 문장의 어미를 -합니다 체로 변경합니다.
    ```
    
    ```python
    # Text
    
    ‘고전문학교육’을 위해 ‘고전 시대의 문학 교육’의 양상을 살펴보는 일은 그 용어의 개념적인 면에서나 실제의 문화적 전통이라는 면에서나 소중한 일임. 이에 대해 ‘과거 제도사’나 ‘학교 제도사’라는 측면에서 역사적 실상을 접근하려는 축과, 중세적 글쓰기의 양상을 간추려 그 문학 교육적 함의를 추론하려는 축으로 그 동안 적지 않은 연구 성과가 축적되었음. 전자가 교육제도의 변천에 중점을 두고 있다면, 후자는 중세 글쓰기의 현재적 가치를 추출해내는 데에 더 중점을 두고 있음. 그러나 모두 ‘고전 시대의 문학 교육’의 양상을 등한시 했다는 결함이 있음. 우리나라 중세시대에서 문학은 지금과는 다른 위치를 차지했음. 중세에는 문인이 사회적 헤게모니를 장악하고 있었고, 당연한 말이겠지만, 그들의 교양 중에서 문학은 다른 교양을 압도하는 주도적이고 본질적인 부분을 차지하고 있었음. 그래서 문학은 가옥의 배열이나 마을의 배치를 설명하거나, 귀신을 내쫓고 운명을 예견하는 일까지도 할 수 있는 것으로 여겨졌음.
    ```
    
    ```python
    # Completion
    
    ‘고전문학교육’을 위해 ‘고전 시대의 문학 교육’의 양상을 살펴보는 일은 그 용어의 개념적인 면에서나 실제의 문화적 전통이라는 면에서나 소중한 일입니다. 이에 대해 ‘과거 제도사’나 ‘학교 제도사’라는 측면에서 역사적 실상을 접근하려는 축과, 중세적 글쓰기의 양상을 간추려 그 문학 교육적 함의를 추론하려는 축으로 그 동안 적지 않은 연구 성과가 축적되었습니다. 전자가 교육제도의 변천에 중점을 두고 있다면, 후자는 중세 글쓰기의 현재적 가치를 추출해내는 데에 더 중점을 두고 있습니다. 그러나 모두 ‘고전 시대의 문학 교육’의 양상을 등한시 했다는 결함이 있습니다. 우리나라 중세시대에서 문학은 지금과는 다른 위치를 차지했습니다. 중세에는 문인이 사회적 헤게모니를 장악하고 있었고, 당연한 말이겠지만, 그들의 교양 중에서 문학은 다른 교양을 압도하는 주도적이고 본질적인 부분을 차지하고 있었습니다. 그래서 문학은 가옥의 배열이나 마을의 배치를 설명하거나, 귀신을 내쫓고 운명을 예견하는 일까지도 할 수 있는 것으로 여겨졌습니다.
    ```
    
- 요약없이 튜닝 결과보기
    
    
    | System | Text | Completion |
    | --- | --- | --- |
    | - 주어진 문장을 -합니다 체로 변경하면서 요약합니다. 
    - 음슴체를 -합니다 체로 변경하면서 요약합니다.
    - 하다 체를 - 합니다 체로 변경하면서 요약합니다. 
    - 요약된 문장의 어미를 -합니다 체로 변경합니다. 
    - 리스트 형태로 요약합니다. 
    ### 예시 
    강점:
    - n개 문체변환 요약 
    약점:
    - n개 문체변환 요약
    종합의견: 
    - n개 문체변환 요약  | 강점,약점,종합의견 3개씩 요약해줘
    손흥민은 공격적인 능력이 특화된 윙어임. 빠른 스피드와 뛰어난 드리블 능력, 정확한 슈팅력으로 유명함. 양발을 자유자재로 사용하는 능력 덕분에 다양한 위치에서 위협적인 득점 찬스를 만들 수 있음. 공격 상황에서의 침투와 위치 선정이 뛰어나며, 상대 수비수들의 허를 찌르는 움직임으로 자주 골을 기록함. 특히 공간을 빠르게 파고드는 능력이 탁월함. 그러나 볼터치가 정교하지 못한 단점이 있음. 손흥민은 또한 수비 가담에도 적극적임. 전방 압박 상황에서 상대의 빌드업을 차단하며 팀의 수비 부담을 덜어주는 역할을 자주 수행함. 그러나 가끔씩 지나친 공격 가담으로 인해 수비로 돌아오는 속도가 늦어질 때가 있음. 이러한 점을 보완하기 위해 체력 관리와 위치 선정에서 더욱 신중해지는 것이 필요함. 또한 몸싸움이 약해 강한 신장을 가진 선수들에게 약한 모습을 보여줌. 국제 무대에서도 활약이 돋보임. 한국 국가대표팀의 주축 선수로서 여러 국제 대회에서 뛰어난 활약을 펼쳤으며, 특히 2018년 러시아 월드컵에서 독일을 상대로 한 골은 역사적인 순간으로 기억됨. 손흥민은 앞으로도 더욱 발전할 가능성이 큰 선수로, 그의 플레이 스타일과 다재다능함은 팀에 큰 자산이 되고 있음.
     | 강점: 
    - 빠른 스피드와 뛰어난 드리블 능력을 가지고 있습니다.
    - 정확한 슈팅력으로 득점 기회를 창출합니다.
    - 양발을 자유자재로 사용하여 다양한 위치에서 득점 기회를 만듭니다.
    약점: 
    - 볼터치가 정교하지 못해 패스미스가 발생할 수 있습니다.
    - 몸싸움이 약해 강한 신장을 가진 선수들에게 약한 모습을 보입니다.
    - 지나친 공격 가담으로 인해 수비로 돌아오는 속도가 늦어질 때가 있습니다.
    종합의견: 
    - 공격적인 능력이 특화된 윙어로, 빠른 스피드와 뛰어난 드리블 능력, 정확한 슈팅력으로 득점 기회를 창출합니다.
    - 양발을 자유자재로 사용하여 다양한 위치에서 득점 기회를 만들 수 있으며, 공격 상황에서의 침투와 위치 선정이 뛰어납니다.
    - 수비 가담에도 적극적이지만, 볼터치가 정교하지 못하고 몸싸움이 약해 강한 신장을 가진 선수들에게 약한 모습을 보입니다. |

**[구글 스프레드시트]**

https://docs.google.com/spreadsheets/d/13qCsMKxqGlCqhiVOldfzXrV8jx2k3oCKMb_EOgVPtVc/edit?gid=347731647#gid=347731647